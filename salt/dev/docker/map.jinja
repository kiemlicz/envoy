{% import_yaml "defaults.yaml" as defaults %}

{% set os = salt['grains.get']('lsb_distrib_id') %}
{% set dist_codename = salt['grains.get']('lsb_distrib_codename') %}

{% set docker = salt['grains.filter_by']({
    'default': {
        'file': '/etc/apt/sources.list.d/docker.list',
         'repo_entries': ["deb [arch=amd64] https://download.docker.com/linux/" + os.lower() + " " + dist_codename + " stable"],
    },
}, merge=salt['grains.filter_by']({

}, grain='oscodename', merge=salt['pillar.get']('docker', default=defaults.docker, merge=True))) %}
